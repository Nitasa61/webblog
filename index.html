<!DOCTYPE html>
<html lang="id">
<head>
    <script src="https://quge5.com/88/tag.min.js" data-zone="196219" async data-cfasync="false"></script>
    <script>(function(s){s.dataset.zone='10377093',s.src='https://gizokraijaw.net/vignette.min.js'})([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')))</script>
    <script src='//libtl.com/sdk.js' data-zone='10377136' data-sdk='show_10377136'></script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F.A HydroFarm Blog - Edukasi Hidroponik</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary-color: #2ecc71; --secondary-color: #27ae60; --text-dark: #333; --text-light: #666; --bg-light: #f9fbf9; --white: #ffffff; --accent-color: #f1c40f; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-light); color: var(--text-dark); line-height: 1.6; }

        header { background-color: var(--white); box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .navbar { max-width: 1200px; margin: 0 auto; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--secondary-color); text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .logo img { height: 40px; width: auto; }
        .logo span { color: var(--text-dark); }
        .btn-store { padding: 0.5rem 1.5rem; background-color: var(--primary-color); color: var(--white); border-radius: 25px; text-decoration: none; font-weight: 600; }

        .hero { 
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1523348837708-15d4a09cfac2?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80'); 
            background-size: cover; background-position: center; height: 450px; display: flex; align-items: center; justify-content: center; text-align: center; color: var(--white); padding: 0 1rem; 
        }
        .hero-content h1 { font-size: 3rem; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .hero-content p { font-size: 1.2rem; max-width: 700px; margin: 0 auto; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }

        .container { max-width: 1200px; margin: 3rem auto; padding: 0 2rem; display: grid; grid-template-columns: 2fr 1fr; gap: 3rem; }
        .section-title { margin-bottom: 2rem; position: relative; padding-bottom: 10px; }
        .section-title::after { content: ''; position: absolute; left: 0; bottom: 0; width: 50px; height: 4px; background-color: var(--primary-color); border-radius: 2px; }

        /* SEARCH BAR STYLE */
        .search-container {
            display: flex; justify-content: center; margin-bottom: 2rem;
        }
        .search-box {
            position: relative; width: 100%; max-width: 500px;
        }
        .search-box input {
            width: 100%; padding: 12px 20px; padding-right: 50px;
            border: 2px solid #eee; border-radius: 50px; outline: none; transition: 0.3s;
            font-family: inherit;
        }
        .search-box input:focus { border-color: var(--primary-color); box-shadow: 0 5px 15px rgba(46, 204, 113, 0.1); }
        .search-box button {
            position: absolute; right: 5px; top: 50%; transform: translateY(-50%);
            background: var(--primary-color); color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: 0.3s;
        }
        .search-box button:hover { background: var(--secondary-color); }

        .blog-card { background: var(--white); border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 2rem; display: flex; flex-direction: column; transition: transform 0.3s; }
        .blog-card:hover { transform: translateY(-5px); }
        
        .blog-img-container { width: 100%; background-color: #eee; overflow: hidden; position: relative; }
        .blog-img-tag { width: 100%; display: block; transition: 0.3s; height: auto; object-fit: contain; }
        .is-portrait { height: 280px !important; object-fit: cover !important; object-position: top center !important; }

        .blog-info { padding: 1.5rem; }
        .blog-meta { font-size: 0.85rem; color: var(--primary-color); margin-bottom: 0.5rem; font-weight: 600; text-transform: uppercase; }
        .blog-title { font-size: 1.5rem; margin-bottom: 1rem; color: var(--text-dark); word-wrap: break-word; }
        
        .blog-excerpt { 
            color: var(--text-light); margin-bottom: 1.5rem;
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis;
            word-break: break-word; overflow-wrap: break-word;
        }

        .read-more { text-decoration: none; color: var(--secondary-color); font-weight: 700; display: inline-flex; align-items: center; gap: 5px; cursor: pointer; }
        
        /* PAGINATION STYLE */
        .pagination { display: flex; justify-content: center; gap: 8px; margin-top: 2rem; }
        .page-btn {
            width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
            border: 1px solid #eee; background: white; border-radius: 5px; cursor: pointer; 
            color: var(--text-dark); font-weight: 600; transition: 0.2s;
        }
        .page-btn:hover { background-color: #f0f0f0; }
        .page-btn.active { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        .page-btn.nav-btn { width: auto; padding: 0 15px; }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .sidebar-widget { background: var(--white); padding: 1.5rem; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 2rem; }
        .widget-title { font-size: 1.2rem; margin-bottom: 1rem; border-bottom: 2px solid #eee; padding-bottom: 0.5rem; }
        .category-list { list-style: none; } 
        .category-list li { margin-bottom: 0.8rem; border-bottom: 1px dotted #eee; padding-bottom: 5px; } 
        .category-list a { text-decoration: none; color: var(--text-light); display: flex; justify-content: space-between; font-weight: 500; cursor: pointer; }
        .category-list a:hover, .category-list a.active-cat { color: var(--primary-color); font-weight: 700; }
        .notification-box { background-color: #e8f8f5; border-left: 4px solid var(--primary-color); padding: 1rem; font-size: 0.9rem; color: var(--text-dark); margin-bottom: 10px; border-radius: 0 5px 5px 0;}
        .notification-box.promo { background-color: #fcf3cf; border-color: var(--accent-color); }
        .empty-state { text-align: center; padding: 40px; background: white; border-radius: 10px; color: #777; }
        
        footer { background-color: var(--text-dark); color: var(--white); padding: 3rem 2rem; text-align: center; }
        .footer-content { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 2rem; text-align: left; }
        .footer-column h3 { color: var(--primary-color); margin-bottom: 1rem; }
        .footer-bottom { margin-top: 3rem; padding-top: 1rem; border-top: 1px solid #444; font-size: 0.9rem; color: #888; }
        
        @media (max-width: 768px) { .container { grid-template-columns: 1fr; } .navbar { flex-direction: column; gap: 1rem; } }
    </style>
</head>
<body>

    <header>
        <nav class="navbar">
            <a href="index.html" class="logo">
                <img src="logo.png" alt="Logo"> F.A HydroFarm <span>Blog</span>
            </a>
            <a href="https://sayur.pages.dev/" class="btn-store">Ke Toko Online</a>
        </nav>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1>Belajar Hidroponik Itu Mudah</h1>
            <p>Temukan informasi hidroponik yang bermanfaat untuk pertanian ramah lingkungan dan gaya hidup sehat.</p>
        </div>
    </section>

    <main class="container">
        
        <section class="blog-grid">
            
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Cari judul artikel..." onkeyup="handleSearch()">
                    <button><i class="fas fa-search"></i></button>
                </div>
            </div>

            <h2 class="section-title" id="pageTitle">Artikel Terbaru</h2>
            
            <div id="blogContainer" style="min-height: 200px;">
                <div style="text-align: center; color: #888;">Sedang memuat artikel...</div>
            </div>

            <div class="pagination" id="paginationContainer"></div>

        </section>

        <aside>
            <div class="sidebar-widget">
                <h3 class="widget-title">üì¢ Pemberitahuan</h3>
                <div id="notificationContainer">
                    <p style="font-size: 0.8rem; color: #888;">Memuat info...</p>
                </div>
            </div>

            <div class="sidebar-widget">
                <h3 class="widget-title">Kategori</h3>
                <ul class="category-list">
                    <li><a onclick="filterKategori('Semua', this)">üìÇ Semua Artikel</a></li>
                    <li><a onclick="filterKategori('Tutorial', this)">Tutorial</a></li>
                    <li><a onclick="filterKategori('Tips & Trik', this)">Tips & Trik</a></li>
                    <li><a onclick="filterKategori('Berita', this)">Berita</a></li>
                    <li><a onclick="filterKategori('Nutrisi', this)">Nutrisi</a></li>
                    <li><a onclick="filterKategori('Hama', this)">Hama</a></li>
                </ul>
            </div>
        </aside>

    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>F.A HydroFarm</h3>
                <p>Belajar, Bertanam, dan Tumbuh Bersama.</p>
            </div>
            <div class="footer-column">
                <h3>Tautan Cepat</h3>
                <ul style="list-style: none; line-height: 2;">
                    <li><a href="#" style="color: #aaa; text-decoration: none;">Tentang Kami</a></li>
                    <li><a href="https://www.instagram.com/fa_hydrofarm" target="_blank" style="color: #aaa; text-decoration: none;">Kontak (Instagram)</a></li>
                    <li><a href="privacy.html" style="color: #aaa; text-decoration: none;">Kebijakan Privasi</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 F.A HydroFarm. All Rights Reserved.
        </div>
    </footer>

    <script>
        function checkImageOrientation(img) {
            if (img.naturalHeight > img.naturalWidth) img.classList.add('is-portrait');
            else img.classList.remove('is-portrait');
        }

        // Panggil Iklan Interstitial (Sesuai Gambar)
        // Pastikan tag.min.js di <head> sudah termuat
        if (typeof show_10377136 === 'function') {
            show_10377136({
                type: 'inApp',
                inAppSettings: {
                    frequency: 2,
                    capping: 0.1,
                    interval: 30,
                    timeout: 5,
                    everyPage: false
                }
            });
        }
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, getDocs, orderBy, query, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAatMmy0V6363AS6HZ965Rcf3c2w2kanSs",
            authDomain: "hydrofarm-blog.firebaseapp.com",
            projectId: "hydrofarm-blog",
            storageBucket: "hydrofarm-blog.firebasestorage.app",
            messagingSenderId: "917850354384",
            appId: "1:917850354384:web:5308f119bd0dd43eaea4d5",
            measurementId: "G-PB1KVVG84Y"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // VARIABEL GLOBAL UNTUK PAGINATION & SEARCH
        let allArticlesData = [];
        let currentPage = 1;
        const itemsPerPage = 5;

        // Load awal
        window.loadArticles = async (filter = 'Semua') => {
            const container = document.getElementById('blogContainer');
            const pageTitle = document.getElementById('pageTitle');
            
            // Ubah Judul
            if (filter !== 'Semua') pageTitle.innerText = "Kategori: " + filter;
            else pageTitle.innerText = "Artikel Terbaru";

            container.innerHTML = `<div style="text-align: center; padding: 20px;">‚è≥ Sedang mengambil data...</div>`;

            try {
                let q;
                if (filter === 'Semua') {
                    q = query(collection(db, "articles"), orderBy("createdAt", "desc"));
                } else {
                    q = query(collection(db, "articles"), where("kategori", "==", filter));
                }

                const querySnapshot = await getDocs(q);
                
                // Simpan data mentah ke variabel global
                allArticlesData = [];
                querySnapshot.forEach(doc => {
                    allArticlesData.push({ id: doc.id, ...doc.data() });
                });

                // Reset ke halaman 1 setiap ganti kategori
                currentPage = 1;
                
                // Render dengan filter & pagination
                renderArticles();

            } catch (error) {
                console.error("Error loading articles:", error);
                container.innerHTML = `<p style="color:red; text-align:center;">Gagal memuat data: ${error.message}</p>`;
            }
        }

        // Fungsi Render Utama (Menangani Search + Pagination)
        window.renderArticles = () => {
            const container = document.getElementById('blogContainer');
            const searchInput = document.getElementById('searchInput').value.toLowerCase();

            // 1. FILTER PENCARIAN
            const filteredData = allArticlesData.filter(art => 
                art.judul.toLowerCase().includes(searchInput)
            );

            // Cek kosong
            if (filteredData.length === 0) {
                container.innerHTML = `<div class="empty-state"><h3>Artikel tidak ditemukan</h3><p>Coba kata kunci lain atau kategori berbeda.</p></div>`;
                document.getElementById('paginationContainer').innerHTML = ''; // Hapus pagination
                return;
            }

            // 2. LOGIKA PAGINATION
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage > totalPages) currentPage = totalPages;
            
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginatedItems = filteredData.slice(start, end);

            // 3. RENDER HTML
            let articlesHtml = '';
            paginatedItems.forEach(data => {
                // Bersihkan HTML tag untuk preview
                const rawContent = data.isi || "";
                const plainText = rawContent.replace(/<[^>]*>?/gm, ' '); 
                const excerpt = plainText.length > 0 ? plainText.substring(0, 150) + "..." : "Klik Baca Selengkapnya...";

                articlesHtml += `
                    <article class="blog-card">
                        <div class="blog-img-container">
                            <img src="${data.gambar}" class="blog-img-tag" onload="checkImageOrientation(this)">
                        </div>
                        <div class="blog-info">
                            <div class="blog-meta">${data.kategori} ‚Ä¢ ${data.tanggal}</div>
                            <h3 class="blog-title">${data.judul}</h3>
                            <p class="blog-excerpt">${excerpt}</p>
                            <a href="article.html?id=${data.id}" class="read-more">Baca Selengkapnya &rarr;</a>
                        </div>
                    </article>
                `;
            });
            container.innerHTML = articlesHtml;

            // 4. RENDER TOMBOL PAGINATION
            renderPaginationControls(totalPages);
        }

        function renderPaginationControls(totalPages) {
            const paginationContainer = document.getElementById('paginationContainer');
            paginationContainer.innerHTML = '';

            if (totalPages <= 1) return; // Tidak perlu pagination jika cuma 1 halaman

            // Tombol Prev
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn nav-btn';
            prevBtn.innerHTML = '&larr;';
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = () => { currentPage--; renderArticles(); window.scrollTo(0,0); };
            paginationContainer.appendChild(prevBtn);

            // Logika Window 3 Halaman (Misal: 1, 2, 3 atau 2, 3, 4)
            let startPage, endPage;
            if (totalPages <= 3) {
                startPage = 1;
                endPage = totalPages;
            } else {
                if (currentPage <= 2) {
                    startPage = 1;
                    endPage = 3;
                } else if (currentPage + 1 >= totalPages) {
                    startPage = totalPages - 2;
                    endPage = totalPages;
                } else {
                    startPage = currentPage - 1;
                    endPage = currentPage + 1;
                }
            }

            for (let i = startPage; i <= endPage; i++) {
                const btn = document.createElement('button');
                btn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
                btn.innerText = i;
                btn.onclick = () => { currentPage = i; renderArticles(); window.scrollTo(0,0); };
                paginationContainer.appendChild(btn);
            }

            // Tombol Next
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn nav-btn';
            nextBtn.innerHTML = '&rarr;';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.onclick = () => { currentPage++; renderArticles(); window.scrollTo(0,0); };
            paginationContainer.appendChild(nextBtn);
        }

        // Event Listener Search
        window.handleSearch = () => {
            currentPage = 1; // Reset ke hal 1 saat mengetik
            renderArticles();
        }

        window.filterKategori = function(kategori, element) {
            document.querySelectorAll('.category-list a').forEach(el => el.classList.remove('active-cat'));
            if(element) element.classList.add('active-cat');
            // Kosongkan search box saat ganti kategori
            document.getElementById('searchInput').value = '';
            window.loadArticles(kategori);
        }

        async function loadNotifications() {
            const container = document.getElementById('notificationContainer');
            try {
                const q = query(collection(db, "notifications"), orderBy("createdAt", "desc"));
                const querySnapshot = await getDocs(q);
                container.innerHTML = ''; 
                if (querySnapshot.empty) { container.innerHTML = '<p style="font-size:0.9rem; color:#999;">Tidak ada info baru.</p>'; return; }
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const typeClass = data.type === 'promo' ? 'promo' : '';
                    const content = data.content ? data.content.replace(/\n/g, '<br>') : '';
                    container.innerHTML += `<div class="notification-box ${typeClass}">${content}</div>`;
                });
            } catch (e) { }
        }

        // Init Load
        window.loadArticles('Semua');
        loadNotifications();
    </script>

</body>
</html>
